"use strict";function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}function initMap(){var r=new ymaps.Map("map",{center:[55.76,37.64],zoom:7});r.behaviors.disable("scrollZoom"),console.log,r.events.add("click",function(e){var t=e.get("coords"),n=new ymaps.Placemark(t,{},{iconLayout:"default#image",iconImageHref:"../../src/img/content/placemark.png"});r.geoObjects.add(n)})}var interval,player=document.querySelector("#player"),btnPlay=document.querySelector("#btnPlay"),btnPlayBig=document.querySelector("#btnPlayBig"),btnMute=document.querySelector("#btnMute"),volume=document.querySelector("#volume"),duration=document.querySelector("#duration");function stopStartVideo(){player.paused||player.ended?(player.play(),btnPlayBig.style.opacity=0):(player.pause(),btnPlayBig.style.opacity=1)}duration.setAttribute("max",player.duration),player.volume=.3,btnPlay.addEventListener("click",function(e){stopStartVideo()}),btnPlayBig.addEventListener("click",function(e){stopStartVideo()}),btnMute.addEventListener("click",function(e){return player.muted=!player.muted}),volume.addEventListener("change",function(e){player.volume=e.target.value/100}),duration.addEventListener("change",function(e){player.currentTime=e.target.value}),player.addEventListener("timeupdate",function(e){return duration.value=e.target.currentTime}),player.addEventListener("ended",function(e){duration.value=0,btnPlayBig.style.opacity=1});var activeSlideIndex=0,flag=!1,secTeamElement=document.querySelector("#sec-team"),secMenuElement=document.querySelector("#sec-menu"),secReasonsElement=document.querySelector("#sec-reasons"),secReviewElement=document.querySelector("#sec-reviews"),secOrderElement=document.querySelector("#sec-order"),secLocationElement=document.querySelector("#sec-locations"),secSliderElement=document.querySelector("#sec-slider"),reviewImgEl=document.querySelector(".review__avatar-img"),reviewHeadingEl=document.querySelector(".review__heading"),reviewDescriptionEl=document.querySelector(".review__description"),reviewSignaturegEl=document.querySelector(".review__signature"),reviewsFormEl=document.forms.formOrder,modalEl=document.querySelector(".js-modal"),btnCloseModalEl=document.querySelector(".js-close-modal");function toggleContent(e){var t=e.target;if(e.preventDefault(),document.query,t.hasAttribute("toggle-content")||(t=findParent(t,"A")),null!==t){var n=findParent(t,"LI");n.classList.toggle("show-content"),_toConsumableArray(n.parentElement.children).filter(function(e){return 1==e.nodeType&&e!=n}).forEach(function(e){e.classList.remove("show-content")})}}function findParent(e,t){var n=e.parentElement;return null===n?null:n.tagName==t?n:findParent(n,t)}function getReviews(){var t=new XMLHttpRequest;t.open("GET","../../src/js/reviews.json"),t.responseType="json",t.send(),t.addEventListener("load",function(e){t.status<400&&initClendar(t.response)})}function initClendar(r){var a=document.querySelector(".reviews__list");r.forEach(function(t){var e=document.createElement("LI");e.className="avatar reviews__item",e.setAttribute("data-index",t.index);var n=document.createElement("A");n.className="avatar reviews__link",n.innerHTML='<img src="src/img/content/'.concat(t.img,'" alt="Avatar" class="avatar__img">'),n.addEventListener("click",function(e){e.preventDefault(),activateReview(r,t.index),launchCalendar(r,t.index++)}),e.appendChild(n),a.appendChild(e)}),launchCalendar(r)}function launchCalendar(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;void 0!==interval&&clearInterval(interval),interval=setInterval(function(){activateReview(e,t),++t>e.length-1&&(t=0)},3e3)}function activateReview(e,t){var n=document.querySelector(".reviews__item--active"),r=document.querySelectorAll(".reviews__item")[t],a=e[t];reviewImgEl.src="src/img/content/photo".concat(t+1,".png"),reviewHeadingEl.innerText=a.heading,reviewDescriptionEl.innerText=a.content,reviewSignaturegEl.innerText=a.name,null!==n&&n.classList.remove("reviews__item--active"),r.classList.add("reviews__item--active")}function sendOrder(e){e.preventDefault();var t=this,n=new FormData(t);n.append("to","test.email@gmail.com");var r=new XMLHttpRequest;r.open("POST","https://webdev-api.loftschool.com/sendmail"),r.send(n),r.responseType="json",r.addEventListener("load",function(){r.status<400?(toggleModal(r.response.message),t.reset()):toggleModal(r.response.message)})}function toggleModal(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"";modalEl.querySelector(".modal__heading").textContent=e,modalEl.classList.toggle("visible")}function moveSlider(e){e.preventDefault();var t=e.target;if(t.hasAttribute("data-move")||(t=findParent(t,"A")),null!==t){var n=e.currentTarget.querySelector(".carousel__list");n.style.transform=flag?"translateX(0)":"translateX(-100%)",flag=!flag}}getReviews(),ymaps.ready(initMap),secTeamElement.addEventListener("click",toggleContent),secMenuElement.addEventListener("click",toggleContent),reviewsFormEl.addEventListener("submit",sendOrder),btnCloseModalEl.addEventListener("click",toggleModal),secSliderElement.addEventListener("click",moveSlider);var wrapper=document.querySelector(".wrapper"),innerWrapper=document.querySelector(".inner-wrapper"),sections=document.querySelectorAll(".section"),paginationItems=document.querySelectorAll(".scroll__item"),menuOpen=document.querySelector(".js-menu-open"),mobileMenu=document.querySelector(".mobile-menu"),mobileMenuClose=document.querySelector(".mobile-menu__close"),headerMenu=document.querySelector(".header__menu"),scrollElement=document.querySelector(".scroll"),md=new MobileDetect(window.navigator.userAgent),isMobile=md.mobile(),i=0,inScroll=!1;function moveToSection(e){return"".concat(-100*e,"%")}function activatePagination(e){var t=document.querySelector(".scroll__item--active");null!==t&&t.classList.remove("scroll__item--active"),paginationItems[e].classList.add("scroll__item--active")}function openMenu(){mobileMenu.style.display="flex",mobileMenu.style.opacity=1,wrapper.style.height="100%"}function closeMenu(e){var t=e.target;wrapper.style.height="",t.hasAttribute("close-menu")||(t=findParent(t,"A")),null!==t&&(mobileMenu.style.opacity=0,setTimeout(function(){mobileMenu.style.display="none"},500))}function changePaginationColor(e){var t=getComputedStyle(sections[e])["background-color"];"rgba(0, 0, 0, 0)"==t||"rgb(248, 250, 249)"==t?scrollElement.classList.add("scroll--green"):scrollElement.classList.remove("scroll--green")}function menuLinkClick(e){var t;e.preventDefault(),t=void 0!==e.target.dataset.index?Number(e.target.dataset.index):Number(e.target.parentElement.dataset.index),i=t,innerWrapper.style.cssText="transform:translateY(".concat(moveToSection(t),")"),setTimeout(function(){activatePagination(t),changePaginationColor(t)},1e3)}wrapper.addEventListener("wheel",function(e){inScroll||(inScroll=!0,0<e.deltaY&&i<sections.length-1&&i++,e.deltaY<0&&0<i&&i--,innerWrapper.style.cssText="transform:translateY(".concat(moveToSection(i),")"),activatePagination(i),changePaginationColor(i),setTimeout(function(){inScroll=!1},1e3))}),menuOpen.addEventListener("click",openMenu),mobileMenuClose.addEventListener("click",closeMenu),mobileMenu.addEventListener("click",function(e){"A"==e.target.tagName&&(menuLinkClick(e),closeMenu(e))}),headerMenu.addEventListener("click",function(e){"A"==e.target.tagName&&menuLinkClick(e)}),scrollElement.addEventListener("click",function(e){"A"==e.target.tagName&&menuLinkClick(e)}),isMobile&&$(document).swipe({swipe:function(e,t,n,r,a,o){"up"==t&&i<sections.length-1&&i++,0==t&&0<i&&i--,innerWrapper.style.cssText="transform:translateY(".concat(moveToSection(i),")"),activatePagination(i),changePaginationColor(i),setTimeout(function(){inScroll=!1},1e3)}});